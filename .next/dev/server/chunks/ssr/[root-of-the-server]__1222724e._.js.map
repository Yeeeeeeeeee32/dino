{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///home/yezic/dino/app/page.tsx"],"sourcesContent":["import { useEffect, useState, useRef, useCallback } from \"react\";\n\n// --- CHANGED ---\n// We define constants based on \"pixels per second\" now.\n// This makes them independent of frame rate.\nconst GRAVITY_PS2 = 2500; // pixels per second per second\nconst JUMP_STRENGTH_PS = -800; // pixels per second\nconst OBSTACLE_SPEED_PS = 350; // pixels per second\nconst GROUND_Y = 0;\n\n// (These are for collision)\nconst DINO_X_POS = 60;\nconst DINO_WIDTH = 40;\nconst DINO_HEIGHT = 40;\nconst OBSTACLE_WIDTH = 40;\nconst OBSTACLE_HEIGHT = 40;\n\n// --- NEW ---\n// Constants for multi-jump\nconst MAX_JUMPS = 2; // Allow a double jump\nconst SECOND_JUMP_MODIFIER = 0.7; // Second jump is 70% as strong\n\nexport default function DinoGame() {\n  const [isJumping, setIsJumping] = useState(false);\n  const [dinoY, setDinoY] = useState(0);\n  const [isGameOver, setIsGameOver] = useState(false);\n  const [score, setScore] = useState(0);\n  const [gameRunning, setGameRunning] = useState(true);\n  const [obstacleX, setObstacleX] = useState(600);\n  const [jumpCount, setJumpCount] = useState(0); // --- NEW ---\n\n  // Velocity is now a ref. It's part of the physics \"engine\"\n  // and doesn't need to trigger a re-render on its own.\n  const velocityRef = useRef<number>(0);\n  const gameLoopRef = useRef<number | null>(null);\n  const lastTimeRef = useRef<number | null>(null);\n\n  const restartGame = () => {\n    setIsGameOver(false);\n    setGameRunning(true);\n    setScore(0);\n    setObstacleX(600);\n    setDinoY(GROUND_Y);\n    velocityRef.current = 0;\n    setIsJumping(false);\n    setJumpCount(0); // --- NEW ---\n  };\n\n  // --- Input Handler (Logic is CHANGED) ---\n  useEffect(() => {\n    const handleKeyDown = (e: { code: string; }) => {\n      if ((e.code === \"Space\" || e.code === \"ArrowUp\") && !isGameOver) {\n        // --- CHANGED ---\n        // This is the new multi-jump logic\n        if (jumpCount < MAX_JUMPS) {\n          let jumpStrength;\n          if (jumpCount === 0) {\n            jumpStrength = JUMP_STRENGTH_PS; // Full power first jump\n          } else {\n            jumpStrength = JUMP_STRENGTH_PS * SECOND_JUMP_MODIFIER; // Weaker 2nd jump\n          }\n          \n          velocityRef.current = jumpStrength;\n          setIsJumping(true); // Ensures gravity applies\n          setJumpCount(jumpCount + 1); // Use the current state value\n        }\n      } else if (isGameOver && e.code === \"Space\") {\n        restartGame();\n      }\n    };\n\n    const handleClick = () => {\n      if (!isGameOver) {\n         // --- CHANGED ---\n         // This is the new multi-jump logic\n        if (jumpCount < MAX_JUMPS) {\n          let jumpStrength;\n          if (jumpCount === 0) {\n            jumpStrength = JUMP_STRENGTH_PS; // Full power first jump\n          } else {\n            jumpStrength = JUMP_STRENGTH_PS * SECOND_JUMP_MODIFIER; // Weaker 2nd jump\n          }\n\n          velocityRef.current = jumpStrength;\n          setIsJumping(true); // Ensures gravity applies\n          setJumpCount(jumpCount + 1); // Use the current state value\n        }\n      } else if (isGameOver) {\n        restartGame();\n      }\n    };\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    window.addEventListener(\"mousedown\", handleClick);\n\n    return () => {\n      window.removeEventListener(\"keydown\", handleKeyDown);\n      window.removeEventListener(\"mousedown\", handleClick);\n    };\n  }, [isGameOver, jumpCount]); // --- CHANGED --- (Added jumpCount)\n\n  // --- Game Loop (One line CHANGED) ---\n  const updateGame = useCallback(() => {\n    // 1. Get current time and calculate delta\n    const currentTime = Date.now();\n    let deltaTime = 0;\n    if (lastTimeRef.current != null) {\n      deltaTime = (currentTime - lastTimeRef.current) / 1000.0; // Delta time in seconds\n    }\n    lastTimeRef.current = currentTime;\n\n    if (!gameRunning) {\n      return; // Don't update if game isn't running\n    }\n\n    // --- Dino Physics ---\n    setDinoY((prevY) => {\n      let newY = prevY;\n      if (isJumping) {\n        // Apply gravity\n        velocityRef.current += GRAVITY_PS2 * deltaTime;\n        // Update position\n        newY += velocityRef.current * deltaTime;\n      }\n\n      // Check for landing\n      if (newY <= GROUND_Y) {\n        newY = GROUND_Y;\n        velocityRef.current = 0;\n        setIsJumping(false);\n        setJumpCount(0); // --- CHANGED --- RESET JUMP COUNTER ON LAND\n      }\n      return newY;\n    });\n\n    // --- Obstacle Movement ---\n    setObstacleX((prevX) => {\n      let newX = prevX - OBSTACLE_SPEED_PS * deltaTime;\n      // If obstacle is off-screen, reset it and add score\n      if (newX < -OBSTACLE_WIDTH) {\n        setScore((s) => s + 1);\n        return 600; // Reset position\n      }\n      return newX;\n    });\n\n    // --- Collision Detection ---\n    const dinoRect = {\n      x: DINO_X_POS,\n      y: dinoY,\n      w: DINO_WIDTH,\n      h: DINO_HEIGHT,\n    };\n    const obstacleRect = {\n      x: obstacleX,\n      y: GROUND_Y,\n      w: OBSTACLE_WIDTH,\n      h: OBSTACLE_HEIGHT,\n    };\n\n    if (\n      dinoRect.x < obstacleRect.x + obstacleRect.w &&\n      dinoRect.x + dinoRect.w > obstacleRect.x &&\n      dinoRect.y < obstacleRect.y + obstacleRect.h &&\n      dinoRect.y + dinoRect.h > obstacleRect.y\n    ) {\n      setIsGameOver(true);\n      setGameRunning(false);\n      return; // Stop the loop\n    }\n\n    // Request the next frame\n    gameLoopRef.current = requestAnimationFrame(updateGame);\n  }, [gameRunning, isJumping, dinoY, obstacleX]);\n\n  // --- Effect to START the loop ---\n  useEffect(() => {\n    if (gameRunning) {\n      // Reset time and start the loop\n      lastTimeRef.current = null;\n      gameLoopRef.current = requestAnimationFrame(updateGame);\n    } else {\n      // Stop the loop\n      if (gameLoopRef.current) {\n        cancelAnimationFrame(gameLoopRef.current);\n      }\n    }\n\n    // Cleanup function\n    return () => {\n      if (gameLoopRef.current) {\n        cancelAnimationFrame(gameLoopRef.current);\n      }\n    };\n  }, [gameRunning, updateGame]); // Start/stop when gameRunning changes\n\n  // --- JSX (No changes) ---\n  return (\n    <div className=\"flex flex-col items-center justify-center h-screen bg-gray-900 text-white\">\n      <h1 className=\"text-2xl font-bold mb-4\">Dino Game</h1>\n      <div className=\"relative w-[600px] h-[200px] bg-gray-800 overflow-hidden border border-gray-600\">\n        <div\n          className=\"absolute left-10 w-10 h-10 bg-green-400 rounded\"\n          style={{ bottom: `${dinoY}px`, left: `${DINO_X_POS}px` }}\n        ></div>\n        <div\n          className=\"absolute bottom-0 w-10 h-10 bg-red-500\"\n          style={{ left: `${obstacleX}px` }}\n        ></div>\n        <div className=\"absolute bottom-0 w-full h-2 bg-gray-500\"></div>\n      </div>\n      <p className=\"mt-4 text-lg\">Score: {score}</p>\n      {isGameOver && (\n        <p className=\"mt-2 text-red-400 font-semibold\">\n          Game Over â€” Press Space or Click to Restart\n        </p>\n      )}\n\n      <style jsx>{`\n        @keyframes cactusMove {\n          0% {\n            right: -50px;\n          }\n          100% {\n            right: 100%;\n          }\n        }\n      `}</style>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}